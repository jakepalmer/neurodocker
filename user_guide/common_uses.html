

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Common Uses &#8212; Neurodocker  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/common_uses';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Minify Containers" href="minify.html" />
    <link rel="prev" title="Examples" href="examples.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    <p class="title logo__title">Neurodocker  documentation</p>
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api.html">
                        API Reference
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api.html">
                        API Reference
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command-line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Common Uses</a></li>
<li class="toctree-l1"><a class="reference internal" href="minify.html">Minify Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="templates_renderers.html">Templates and Renderers</a></li>
<li class="toctree-l1"><a class="reference internal" href="add_template.html">Add software to Neurodocker</a></li>
<li class="toctree-l1"><a class="reference internal" href="known_issues.html">Known Issues</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">User Guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Common Uses</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="common-uses">
<h1>Common Uses<a class="headerlink" href="#common-uses" title="Permalink to this heading">#</a></h1>
<section id="create-locally-and-use-remotely">
<h2>Create locally and use remotely<a class="headerlink" href="#create-locally-and-use-remotely" title="Permalink to this heading">#</a></h2>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>Add content.</p>
</div>
</section>
<section id="working-with-data">
<h2>Working with Data<a class="headerlink" href="#working-with-data" title="Permalink to this heading">#</a></h2>
<p>These are some examples of common use-cases for different stages of the analysis life
cycle. Each example:</p>
<ul class="simple">
<li><p>Generates a <code class="docutils literal notranslate"><span class="pre">Dockerfile</span></code> with <em>Neurodocker</em> (using <em>Neurodocker</em> Docker image and <code class="docutils literal notranslate"><span class="pre">debian:stretch</span></code> base image) that includes specific versions of FSL and ANTs</p></li>
<li><p>Builds the Docker image</p></li>
<li><p>Runs a short processing script (both Bash and Python examples included here). For these examples, we simply skull strip a T1-weighted image with BET and warp it into MNI space with ANTs.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>These example Docker images include FSL and ANTs in order to provide somewhat realistic examples. However, downloading FSL can take some time and the images will be quite large (~12GB).</p></li>
<li><p>The commands in the example scripts likely will not produce good results and should not be used in any real analysis.</p></li>
</ul>
</div>
<section id="running-examples">
<h3>Running examples<a class="headerlink" href="#running-examples" title="Permalink to this heading">#</a></h3>
<p>To run these examples, you will need Docker installed as we will use the <em>Neurodocker</em> docker image. The <em>Neurodocker</em> commands are explained in more detail at the end of this section.</p>
<p>To start, clone <em>Neurodocker</em> from Github and change directory to the cloned <code class="docutils literal notranslate"><span class="pre">./neurodocker/docs/user_guide/working_with_data_example</span></code> directory and create a directory for the output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>./neurodocker/docs/user_guide/working_with_data_example
mkdir<span class="w"> </span>output
</pre></div>
</div>
<p>All the following commands assume they’re being run from the <code class="docutils literal notranslate"><span class="pre">./neurodocker/docs/user_guide/working_with_data_example</span></code> directory.</p>
</section>
<section id="example-1">
<h3>Example 1<a class="headerlink" href="#example-1" title="Permalink to this heading">#</a></h3>
<p>This example creates an image that contains some neuroimaging software and uses a custom Bash script to process the data, reading the script and the data from the local file system, and writing data back to the local file system.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate Dockerfile</span>
docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>repronim/neurodocker:master<span class="w"> </span>generate<span class="w"> </span>docker<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--base<span class="o">=</span>debian:stretch<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--pkg-manager<span class="o">=</span>apt<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--fsl<span class="w"> </span><span class="nv">version</span><span class="o">=</span><span class="m">6</span>.0.4<span class="w"> </span><span class="nv">method</span><span class="o">=</span>binaries<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--ants<span class="w"> </span><span class="nv">version</span><span class="o">=</span><span class="m">2</span>.2.0<span class="w"> </span><span class="nv">method</span><span class="o">=</span>binaries<span class="w"> </span>&gt;<span class="w"> </span>Dockerfile

<span class="c1"># Build</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>neurodocker-example:main<span class="w"> </span>.

<span class="c1"># Run processing script</span>
docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>:/home<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/input:/home/input<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/output:/home/output<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>neurodocker-example:main<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>bash<span class="w"> </span>/home/processing_script.sh
</pre></div>
</div>
</section>
<section id="example-2">
<h3>Example 2<a class="headerlink" href="#example-2" title="Permalink to this heading">#</a></h3>
<p>As for example 1, however here we run a processing script written in Python that also requires some additional Python packages. For this example, we’re installing <code class="docutils literal notranslate"><span class="pre">numpy</span></code> <code class="docutils literal notranslate"><span class="pre">pandas</span></code> and <code class="docutils literal notranslate"><span class="pre">nibabel</span></code> with <code class="docutils literal notranslate"><span class="pre">conda</span></code>. These packages are imported in the script for the sake of example, even though they aren’t used.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate Dockerfile</span>
docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>repronim/neurodocker:master<span class="w"> </span>generate<span class="w"> </span>docker<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--base<span class="o">=</span>debian:stretch<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--pkg-manager<span class="o">=</span>apt<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--fsl<span class="w"> </span><span class="nv">version</span><span class="o">=</span><span class="m">6</span>.0.4<span class="w"> </span><span class="nv">method</span><span class="o">=</span>binaries<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--ants<span class="w"> </span><span class="nv">version</span><span class="o">=</span><span class="m">2</span>.2.0<span class="w"> </span><span class="nv">method</span><span class="o">=</span>binaries<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--miniconda<span class="w"> </span><span class="se">\</span>
<span class="w">        </span><span class="nv">conda_install</span><span class="o">=</span><span class="s2">&quot;python=3.6 pandas numpy nibabel&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">        </span><span class="nv">create_env</span><span class="o">=</span><span class="s2">&quot;analysis&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">        </span><span class="nv">activate</span><span class="o">=</span><span class="nb">true</span><span class="w"> </span>&gt;<span class="w"> </span>Dockerfile

<span class="c1"># Build</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>neurodocker-example-py:main<span class="w"> </span>.

<span class="c1"># Run processing script</span>
docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>:/home<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/input:/home/input<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/output:/home/output<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>neurodocker-example-py:main<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>python3<span class="w"> </span>/home/processing_script.py
</pre></div>
</div>
</section>
<section id="example-3">
<h3>Example 3<a class="headerlink" href="#example-3" title="Permalink to this heading">#</a></h3>
<p>Here we will add the processing scripts to the Docker image and automatically run the processing script on data that is accessed from the local file system. This would allow someone to process data from their local file system with the processing script included in the Docker image.</p>
<p><strong>Bash:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate Dockerfile</span>
docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>repronim/neurodocker:master<span class="w"> </span>generate<span class="w"> </span>docker<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--base<span class="o">=</span>debian:stretch<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--pkg-manager<span class="o">=</span>apt<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--fsl<span class="w"> </span><span class="nv">version</span><span class="o">=</span><span class="m">6</span>.0.4<span class="w"> </span><span class="nv">method</span><span class="o">=</span>binaries<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--ants<span class="w"> </span><span class="nv">version</span><span class="o">=</span><span class="m">2</span>.2.0<span class="w"> </span><span class="nv">method</span><span class="o">=</span>binaries<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--copy<span class="w"> </span><span class="s2">&quot;processing_script.sh&quot;</span><span class="w"> </span><span class="s2">&quot;/home&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--add-to-entrypoint<span class="w"> </span><span class="s2">&quot;bash /home/processing_script.sh&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--cmd<span class="w"> </span><span class="s2">&quot;exit&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>Dockerfile

<span class="c1"># Build</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>neurodocker-example:main<span class="w"> </span>.

<span class="c1"># Run processing script</span>
docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/input:/home/input<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/output:/home/output<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>neurodocker-example:main
</pre></div>
</div>
<p><strong>Python:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate Dockerfile</span>
docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>repronim/neurodocker:master<span class="w"> </span>generate<span class="w"> </span>docker<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--base<span class="o">=</span>debian:stretch<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--pkg-manager<span class="o">=</span>apt<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--fsl<span class="w"> </span><span class="nv">version</span><span class="o">=</span><span class="m">6</span>.0.4<span class="w"> </span><span class="nv">method</span><span class="o">=</span>binaries<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--ants<span class="w"> </span><span class="nv">version</span><span class="o">=</span><span class="m">2</span>.2.0<span class="w"> </span><span class="nv">method</span><span class="o">=</span>binaries<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--miniconda<span class="w"> </span><span class="se">\</span>
<span class="w">        </span><span class="nv">conda_install</span><span class="o">=</span><span class="s2">&quot;python=3.6 pandas numpy nibabel&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">        </span><span class="nv">create_env</span><span class="o">=</span><span class="s2">&quot;analysis&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">        </span><span class="nv">activate</span><span class="o">=</span><span class="nb">true</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--copy<span class="w"> </span><span class="s2">&quot;processing_script.py&quot;</span><span class="w"> </span><span class="s2">&quot;/home&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--add-to-entrypoint<span class="w"> </span><span class="s2">&quot;python3 /home/processing_script.py&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--cmd<span class="w"> </span><span class="s2">&quot;exit&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>Dockerfile

<span class="c1"># Build</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>neurodocker-example-py:main<span class="w"> </span>.

<span class="c1"># Run processing script</span>
docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/input:/home/input<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/output:/home/output<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>neurodocker-example-py:main
</pre></div>
</div>
</section>
<section id="example-4">
<h3>Example 4<a class="headerlink" href="#example-4" title="Permalink to this heading">#</a></h3>
<p>As for example 3, however here the processing script and the data are added to the Docker image. This would allow someone to simply <cite>run</cite> the Docker image to execute the processing script on the data that is included in the Docker image, still writing the output to the local file system to be inspected. This approach may be useful for someone who doesn’t need to see the processing scripts or data and simply wants to run the pipeline, get a result, and check it against a published paper.</p>
<p>Note that although the processing scripts and input data are included in the Docker image, we still need to ensure that the output directory exists on our local file system and it needs to be mounted to the output directory of the Docker container (<cite>-v ${PWD}/output:/home/output</cite>).</p>
<p><strong>Bash:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate Dockerfile</span>
docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>repronim/neurodocker:master<span class="w"> </span>generate<span class="w"> </span>docker<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--base<span class="o">=</span>debian:stretch<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--pkg-manager<span class="o">=</span>apt<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--fsl<span class="w"> </span><span class="nv">version</span><span class="o">=</span><span class="m">6</span>.0.4<span class="w"> </span><span class="nv">method</span><span class="o">=</span>binaries<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--ants<span class="w"> </span><span class="nv">version</span><span class="o">=</span><span class="m">2</span>.2.0<span class="w"> </span><span class="nv">method</span><span class="o">=</span>binaries<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--copy<span class="w"> </span>.<span class="w"> </span><span class="s2">&quot;/home&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--run<span class="w"> </span><span class="s2">&quot;mkdir -p /home/output&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--add-to-entrypoint<span class="w"> </span><span class="s2">&quot;bash /home/processing_script.sh&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--cmd<span class="w"> </span><span class="s2">&quot;exit&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>Dockerfile

<span class="c1"># Build</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>neurodocker-example:main<span class="w"> </span>.

<span class="c1"># Run processing script</span>
docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/output:/home/output<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>neurodocker-example:main
</pre></div>
</div>
<p><strong>Python:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate Dockerfile</span>
docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>repronim/neurodocker:master<span class="w"> </span>generate<span class="w"> </span>docker<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--base<span class="o">=</span>debian:stretch<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--pkg-manager<span class="o">=</span>apt<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--fsl<span class="w"> </span><span class="nv">version</span><span class="o">=</span><span class="m">6</span>.0.4<span class="w"> </span><span class="nv">method</span><span class="o">=</span>binaries<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--ants<span class="w"> </span><span class="nv">version</span><span class="o">=</span><span class="m">2</span>.2.0<span class="w"> </span><span class="nv">method</span><span class="o">=</span>binaries<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--miniconda<span class="w"> </span><span class="se">\</span>
<span class="w">        </span><span class="nv">conda_install</span><span class="o">=</span><span class="s2">&quot;python=3.6 pandas numpy nibabel&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">        </span><span class="nv">create_env</span><span class="o">=</span><span class="s2">&quot;analysis&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">        </span><span class="nv">activate</span><span class="o">=</span><span class="nb">true</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--copy<span class="w"> </span>.<span class="w"> </span><span class="s2">&quot;/home&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--run<span class="w"> </span><span class="s2">&quot;mkdir -p /home/output&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--add-to-entrypoint<span class="w"> </span><span class="s2">&quot;python3 /home/processing_script.py&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--cmd<span class="w"> </span><span class="s2">&quot;exit&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>Dockerfile

<span class="c1"># Build</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>neurodocker-example-py:main<span class="w"> </span>.

<span class="c1"># Run processing script</span>
docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/output:/home/output<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>neurodocker-example-py:main
</pre></div>
</div>
</section>
<section id="components-of-neurodocker-command">
<h3>Components of <em>Neurodocker</em> command<a class="headerlink" href="#components-of-neurodocker-command" title="Permalink to this heading">#</a></h3>
<p>This component is common to all commands in these examples and simply selects the base image and the neuroimaging software to be included.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>repronim/neurodocker:master<span class="w"> </span>generate<span class="w"> </span>docker<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--base<span class="o">=</span>debian:stretch<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--pkg-manager<span class="o">=</span>apt<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--fsl<span class="w"> </span><span class="nv">version</span><span class="o">=</span><span class="m">6</span>.0.4<span class="w"> </span><span class="nv">method</span><span class="o">=</span>binaries<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--ants<span class="w"> </span><span class="nv">version</span><span class="o">=</span><span class="m">2</span>.2.0<span class="w"> </span><span class="nv">method</span><span class="o">=</span>binaries<span class="w"> </span><span class="se">\</span>
</pre></div>
</div>
<p>The Miniconda distribution is used for Docker images where Python is also required. In these examples we install Python version 3.6 and also use the <cite>conda</cite> package manager to install the additional packages. We then create a virtual environment within the Docker container and activate it automatically.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>--miniconda<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="nv">conda_install</span><span class="o">=</span><span class="s2">&quot;python=3.6 pandas numpy nibabel&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="nv">create_env</span><span class="o">=</span><span class="s2">&quot;analysis&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="nv">activate</span><span class="o">=</span><span class="nb">true</span><span class="w"> </span><span class="se">\</span>
</pre></div>
</div>
<p>Next we copy the processing script (example 3) or the script and the data (example 4) to the Docker image.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Copy script only</span>
--copy<span class="w"> </span><span class="s2">&quot;processing_script.py&quot;</span><span class="w"> </span><span class="s2">&quot;/home&quot;</span><span class="w"> </span><span class="se">\</span>

<span class="c1"># Copy everything in current working directory (here, scripts and data)</span>
--copy<span class="w"> </span>.<span class="w"> </span><span class="s2">&quot;/home&quot;</span><span class="w"> </span><span class="se">\</span>
</pre></div>
</div>
<p>Make sure the output directory exists in the Docker image.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>--run<span class="w"> </span><span class="s2">&quot;mkdir -p /home/output&quot;</span><span class="w"> </span><span class="se">\</span>
</pre></div>
</div>
<p>Set the processing script to be run automatically when the Docker container is initiated and return to the local command line when finished. The container entrypoint are commands that are run automatically when the container is initiated. Therefore, we’re adding a command to run the processing script to be executed when the container is initiated. The last <cite>&gt; Dockerfile</cite> component writes the output of the _Neurodocker_ command to a file called <cite>Dockerfile</cite>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>--add-to-entrypoint<span class="w"> </span><span class="s2">&quot;python3 /home/processing_script.py&quot;</span><span class="w"> </span><span class="se">\</span>
--cmd<span class="w"> </span><span class="s2">&quot;exit&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>Dockerfile
</pre></div>
</div>
</section>
</section>
<section id="jupyter-notebook">
<h2>Jupyter Notebook<a class="headerlink" href="#jupyter-notebook" title="Permalink to this heading">#</a></h2>
<p>This example demonstrates how to build and run an image with Jupyter Notebook.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When you exit a Docker image, any files you created in that image are lost. So if
you create Jupyter Notebooks while in a Docker image, remember to save them to
a mounted directory. Otherwise, the notebooks will be deleted (and unrecoverable)
after you exit the Docker image.</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>neurodocker<span class="w"> </span>generate<span class="w"> </span>docker<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--pkg-manager<span class="w"> </span>apt<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--base-image<span class="w"> </span>debian:buster-slim<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--miniconda<span class="w"> </span><span class="se">\</span>
<span class="w">        </span><span class="nv">version</span><span class="o">=</span>latest<span class="w"> </span><span class="se">\</span>
<span class="w">        </span><span class="nv">conda_install</span><span class="o">=</span><span class="s2">&quot;matplotlib notebook numpy pandas seaborn&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--user<span class="w"> </span>nonroot<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--workdir<span class="w"> </span>/work<span class="w"> </span><span class="se">\</span>
&gt;<span class="w"> </span>notebook.Dockerfile

<span class="c1"># Build the image.</span>
docker<span class="w"> </span>build<span class="w"> </span>--tag<span class="w"> </span>notebook<span class="w"> </span>--file<span class="w"> </span>notebook.Dockerfile<span class="w"> </span>.

<span class="c1"># Run the image. The current directory is mounted to the working directory of the</span>
<span class="c1"># Docker image, so our notebooks are saved to the current directory.</span>
docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-it<span class="w"> </span>--publish<span class="w"> </span><span class="m">8888</span>:8888<span class="w"> </span>--volume<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>:/work<span class="w"> </span>notebook<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>jupyter-notebook<span class="w"> </span>--no-browser<span class="w"> </span>--ip<span class="w"> </span><span class="m">0</span>.0.0.0
</pre></div>
</div>
</section>
<section id="multiple-conda-environments">
<h2>Multiple Conda Environments<a class="headerlink" href="#multiple-conda-environments" title="Permalink to this heading">#</a></h2>
<p>This example demonstrates how to create a Docker image with multiple conda environments.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>neurodocker<span class="w"> </span>generate<span class="w"> </span>docker<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--pkg-manager<span class="w"> </span>apt<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--base-image<span class="w"> </span>debian:buster-slim<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--miniconda<span class="w"> </span><span class="se">\</span>
<span class="w">        </span><span class="nv">version</span><span class="o">=</span>latest<span class="w"> </span><span class="se">\</span>
<span class="w">        </span><span class="nv">env_name</span><span class="o">=</span>envA<span class="w"> </span><span class="se">\</span>
<span class="w">        </span><span class="nv">env_exists</span><span class="o">=</span><span class="nb">false</span><span class="w"> </span><span class="se">\</span>
<span class="w">        </span><span class="nv">conda_install</span><span class="o">=</span>pandas<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--miniconda<span class="w"> </span><span class="se">\</span>
<span class="w">        </span><span class="nv">version</span><span class="o">=</span>latest<span class="w"> </span><span class="se">\</span>
<span class="w">        </span><span class="nv">installed</span><span class="o">=</span><span class="nb">true</span><span class="w"> </span><span class="se">\</span>
<span class="w">        </span><span class="nv">env_name</span><span class="o">=</span>envB<span class="w"> </span><span class="se">\</span>
<span class="w">        </span><span class="nv">env_exists</span><span class="o">=</span><span class="nb">false</span><span class="w"> </span><span class="se">\</span>
<span class="w">        </span><span class="nv">conda_install</span><span class="o">=</span>scipy<span class="w"> </span><span class="se">\</span>
&gt;<span class="w"> </span>multi-conda-env.Dockerfile

docker<span class="w"> </span>build<span class="w"> </span>--tag<span class="w"> </span>multi-conda-env<span class="w"> </span>--file<span class="w"> </span>multi-conda-env.Dockerfile<span class="w"> </span>.
</pre></div>
</div>
<p>One can use the image in the following way:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-it<span class="w"> </span>multi-conda-env<span class="w"> </span>bash
<span class="c1"># Pandas is installed in envA.</span>
conda<span class="w"> </span>activate<span class="w"> </span>envA
python<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import pandas&quot;</span>
<span class="c1"># Scipy is installed in envB.</span>
conda<span class="w"> </span>activate<span class="w"> </span>envB
python<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import scipy&quot;</span>
</pre></div>
</div>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="examples.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Examples</p>
      </div>
    </a>
    <a class="right-next"
       href="minify.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Minify Containers</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-locally-and-use-remotely">Create locally and use remotely</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-data">Working with Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#running-examples">Running examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1">Example 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2">Example 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3">Example 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-4">Example 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#components-of-neurodocker-command">Components of <em>Neurodocker</em> command</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jupyter-notebook">Jupyter Notebook</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-conda-environments">Multiple Conda Environments</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../_sources/user_guide/common_uses.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner"></div>
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2021, Neurodocker Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://sphinx-doc.org/">Sphinx</a> 5.3.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>